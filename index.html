<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>한국철도역 단어대결</title>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<style>
body { font-family: Arial; text-align: center; margin-top: 50px; background-color: #f5f5f5; }
#gameArea { display: none; }
#userInput { width: 200px; padding: 5px; font-size: 16px; }
button { padding: 10px 20px; font-size: 16px; cursor: pointer; margin: 5px; }
#timer { font-size: 24px; margin: 20px; }
#score { font-size: 20px; margin: 10px; }
#aiWord { font-size: 18px; color: #555; margin: 10px; }
</style>
</head>
<body>

<h1>한국철도역 단어대결</h1>
<p>AI와 1분 동안 역 이름으로 단어대결!</p>

<button id="loginBtn">구글 로그인</button>

<div id="gameArea">
  <button id="startBtn">게임 시작</button>
  <div id="timer">60</div>
  <input type="text" id="userInput" placeholder="역 이름 입력">
  <button id="submitBtn">제출</button>
  <div id="aiWord"></div>
  <div id="score">점수: 0</div>
  <button id="logoutBtn">로그아웃</button>
</div>

<script>
  // 🔹 Firebase 설정 (자신의 Firebase 프로젝트 정보로 교체)
  const firebaseConfig = {
    apiKey: "AIzaSyC8DLOstSDns6rV-B30ZoLkiRu9A9mY0uc",
    authDomain: "station-game-7fcc8.firebaseapp.com",
    projectId: "station-game-7fcc8",
  };
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();

  const loginBtn = document.getElementById("loginBtn");
  const logoutBtn = document.getElementById("logoutBtn");
  const gameArea = document.getElementById("gameArea");

  // 로그인
  loginBtn.onclick = () => {
    const provider = new firebase.auth.GoogleAuthProvider();
    auth.signInWithPopup(provider);
  };

  // 로그아웃
  logoutBtn.onclick = () => {
    auth.signOut();
  };

  // 로그인 상태 체크
  auth.onAuthStateChanged(user => {
    if(user){
      loginBtn.style.display = "none";
      gameArea.style.display = "block";
    } else {
      loginBtn.style.display = "inline-block";
      gameArea.style.display = "none";
    }
  });

  // 게임 로직
  const koreanStations = ["서울","부산","대구","인천","광주","대전","울산","수원","춘천","강릉","목포","여수","제주","청주","전주","천안"];
  let timer, timeLeft, score, usedStations;

  const startBtn = document.getElementById("startBtn");
  const timerDisplay = document.getElementById("timer");
  const scoreDisplay = document.getElementById("score");
  const aiWordDisplay = document.getElementById("aiWord");
  const userInput = document.getElementById("userInput");
  const submitBtn = document.getElementById("submitBtn");

  startBtn.onclick = () => {
    timeLeft = 60;
    score = 0;
    usedStations = [];
    timerDisplay.textContent = timeLeft;
    scoreDisplay.textContent = "점수: " + score;
    aiWordDisplay.textContent = "";
    userInput.value = "";
    userInput.focus();

    timer = setInterval(() => {
      timeLeft--;
      timerDisplay.textContent = timeLeft;
      if(timeLeft <= 0){
        clearInterval(timer);
        alert("시간 종료! 최종 점수: " + score);
      }
    }, 1000);
  };

  submitBtn.onclick = () => {
    const userWord = userInput.value.trim();
    if(!userWord) return;
    if(!koreanStations.includes(userWord)){
      alert("올바른 역 이름이 아닙니다!");
      userInput.value="";
      return;
    }
    if(usedStations.includes(userWord)){
      alert("이미 사용한 역 이름입니다!");
      userInput.value="";
      return;
    }

    score++;
    usedStations.push(userWord);

    const available = koreanStations.filter(s => !usedStations.includes(s));
    let aiWord = "";
    if(available.length>0){
      aiWord = available[Math.floor(Math.random()*available.length)];
      usedStations.push(aiWord);
      aiWordDisplay.textContent = "AI: " + aiWord;
    } else {
      aiWordDisplay.textContent = "AI: 단어 없음!";
    }

    scoreDisplay.textContent = "점수: " + score;
    userInput.value = "";
    userInput.focus();
  };

  userInput.addEventListener("keydown", e=>{
    if(e.key==="Enter") submitBtn.click();
  });
</script>

</body>
</html>
